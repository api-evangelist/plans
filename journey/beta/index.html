---
layout: page
title: 'API Journey - Beta'
---

<script type="text/javascript">

  var $this_line = "plans";
  var $current_area = "";
  var $area_count = 0;
  var $area_full_count = 0;

  var $current_stop = "";
  var $stop_count = 0;
  var $stop_full_count = 0;

  var $previous_stop = 0;
  var $current_stop = 0;
  var $next_stop = 0;

  var $full_line = "";
  var $full_area = "";
  var $full_stops = "";

  function loadareastops($area,$begin)
    {

    $current_area = $area;
    $("#line-area").html('{"' + $area + '"}');
    $stops_url = "http://buildingblock.api.kinlane.com/buildingblocks/subway/lines/" + $this_line + "/areas/" + $area + "/stops/";
    //console.log("loading..." + $stops_url);

    $.ajax({
        url: $stops_url,
        type:"GET",
        contentType:"application/vnd.siren+json",
      success:function($stopdata) {

        $full_stops = $stopdata	;

          if($begin=='last')
            {
            $entities = $full_stops['entities'];
            $movetostop = $entities.length - 1;
            //console.log($begin + ' - ' + $movetostop);

          $previous_stop = $movetostop-2;
          $current_stop = $movetostop-1;
          $next_stop = $movetostop;

          loadstops('next');
          }
        else
          {
          $previous_stop = 0;
          $current_stop = 0;
          $next_stop = 1;

          loadstops('');
          }

          $stops_links = $stopdata['links'];
          }
      });

    $area_count++;

    }

  function loadstops($movestop)
    {

    if($movestop=='prev')
      {
      //console.log("setting prev to: " + $previous_stop);
      $thisstop = $previous_stop;
      }
    else if($movestop=='next')
      {
      $thisstop = $next_stop;
      //console.log("setting next to: " + $next_stop);
      }
    else
      {
      $thisstop = $current_stop;
      }

      $stops_properties = $full_stops['properties'];
      $stops_entities = $full_stops['entities'];

    $stop_full_count = $stops_entities.length;
    $("#totalstops").html($stop_full_count);

      //console.log("Top: " + $thisstop);

    if($thisstop==0)
      {

      //console.log("Area: " + $area_count);

      if($area_count==1)
        {
        //console.log("Area: " + $area_count);

        $circle_image = "https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-api-subway-circle.png";
        $('#prev-circle').attr("src",$circle_image);
        $('#prev-circle').attr("width","50");
        }
      else if($area_count > 1 && $movestop=='prev')
        {
        //console.log("Area: " + $area_count);

        // Move to Previous Area
        $useArea = $full_area[$area_count-2]['name'];
        //console.log("moving to area: " + $useArea);
        loadareastops($useArea,'last');
        }


      $("#stop-one-name").hide();
      $("#stop-one-circle").hide();

      $("#stop-two-circle").css('top', '53%');
      $("#stop-two-name").css('top', '54%');
      $("#stop-two-name").show();
      $("#stop-two-circle").show();

      $("#stop-three-circle").css('top', '63%');
      $("#stop-three-name").css('top', '64%');
      $("#stop-three-name").show();
      $("#stop-three-circle").show();

      $("#stop-four-circle").css('top', '73%');
      $("#stop-four-name").css('top', '74%');
      $("#stop-four-name").show();
      $("#stop-four-circle").show();

      if($stops_entities[$thisstop])
        {
          $stop_one_name = $stops_entities[$thisstop]['properties']['name'];
          $stop_one_about = $stops_entities[$thisstop]['properties']['about'];

          $("#stop-two-name").html($stop_one_name);

          $("#line-stop-title").html($stop_one_name);
          $("#line-stop-about").html($stop_one_about);
          }

      if($stops_entities[$thisstop+1])
        {
          $stop_two_name =$stops_entities[$thisstop+1]['properties']['name'];
          $("#stop-three-name").html($stop_two_name);
          }

      if($stops_entities[$thisstop+2])
        {
          $stop_three_name =$stops_entities[$thisstop+2]['properties']['name'];
          $("#stop-four-name").html($stop_three_name);
          }

      }
    else
      {

      $circle_image = "https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-api-subway-circle-previous.png";
      $('#prev-circle').attr("src",$circle_image);
      $('#prev-circle').attr("width","175");

      $("#stop-one-circle").css('top', '53%');
      $("#stop-one-name").css('top', '54%');
      $("#stop-one-name").show();
      $("#stop-one-circle").show();

      $("#stop-two-circle").css('top', '63%');
      $("#stop-two-name").css('top', '64%');
      $("#stop-two-name").show();
      $("#stop-two-circle").show();

      $("#stop-three-circle").css('top', '73%');
      $("#stop-three-name").css('top', '74%');
      $("#stop-three-name").show();
      $("#stop-three-circle").show();

      $("#stop-four-name").hide();
      $("#stop-four-circle").hide();

        if($stops_entities[$thisstop-1])
          {
          $stop_one_name = $stops_entities[$thisstop-1]['properties']['name'];
          $stop_one_about = $stops_entities[$thisstop-1]['properties']['about'];

          $("#stop-one-name").html($stop_one_name);
          }

        if($stops_entities[$thisstop])
          {
          $stop_two_name = $stops_entities[$thisstop]['properties']['name'];
          $stop_two_about = $stops_entities[$thisstop]['properties']['about'];

          $("#stop-two-name").html($stop_two_name);
          $("#line-stop-title").html($stop_two_name);
          $("#line-stop-about").html($stop_two_about);
          }

        if($stops_entities[$thisstop+1])
          {
          $stop_three_name = $stops_entities[$thisstop+1]['properties']['name'];
          $stop_three_about = $stops_entities[$thisstop+1]['properties']['about'];
          $("#stop-three-name").html($stop_three_name);
          }

      $previous_stop = $thisstop - 1;
      $current_stop = $thisstop;
      $next_stop = $thisstop + 1;

      $("#prevcount").html($previous_stop);
      $("#nextcount").html($next_stop);

      //console.log("here: " + $stop_full_count);

      if($thisstop == $stop_full_count-1)
        {
        $("#stop-three-name").hide();
        $("#stop-three-circle").hide();
        }

      if($thisstop == $stop_full_count)
        {

        $loadNextArea = "";
        $nextArea = 0;

        $.each($full_area, function($areaKey, $areaValue) {
          $thisName = $areaValue['name'];
          //console.log($thisName + ' == ' + $current_area);
          if($thisName==$current_area)
            {
            $nextArea = 1;
            }
          else if($nextArea == 1)
            {
            $loadNextArea = $thisName;
            $nextArea = 3;
            }
          });

        //console.log($stop_full_count + ' == ' + $stop_count);

        $("#stop-one-name").hide();
        $("#stop-one-circle").hide();
        $("#stop-two-name").hide();
        $("#stop-two-circle").hide();
        $("#stop-three-name").hide();
        $("#stop-three-circle").hide();
        $("#stop-four-name").hide();
        $("#stop-four-circle").hide();

        loadareastops($loadNextArea,'');

        }
      else
        {
        $circle_image = "https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-api-subway-circle-next.png";
        $('#next-circle').attr("src",$circle_image);
        $('#next-circle').attr("width","175");
        }

      }

    }

  $subway_url = "http://buildingblock.api.kinlane.com/buildingblocks/subway/lines/" + $this_line + "/";
  //console.log("loading..." + $subway_url);

  $.ajax({
    url: $subway_url,
    type:"GET",
    contentType:"application/vnd.siren+json",
    success:function(data) {

      $full_line = data;

    // What are the properties?
        $rel = data['rel'];
        //console.log("rel: " + $rel);

    // What are the properties?
        $properties = data['properties'];

        // What are the entities?
        $entities = data['entities'];

      $line_name = $properties['line'];
      $("#line-name").html($line_name);

      $line_sort_order = $properties['sort_order'];

      $line_hex = $properties['hex'];
      $("#line-hex-1").css('background-color', $line_hex);
      $("#line-hex-2").css('background-color', $line_hex);

      $line_image = $properties['image'];
      $('#line-image').attr("src",$line_image);

      //console.log($line_name, "(" + $line_sort_order + ") - #" + $line_hex + " - " + $line_image);

      $line_areas= $properties['areas'];

      $full_area = $line_areas;

      $area_full_count = $full_area.length;
      $("#totalareas").html($area_full_count);

    $.each($line_areas, function($areaKey, $areaValue) {

      $name = $areaValue['name'];
      $sort_order = $areaValue['sort_order'];

      if($current_area=="")
        {
        $current_area = $name;
        loadareastops($current_area,'');
        }

      });

        // What links are available to us?
        $links = data['links'];
        //console.log("links: " + $links);

      }
  });

</script>

<body>

<table width="100%" cellpadding="1" cellslpacing="1" border="0">
  <tr>
    <td width="20%" valign="top">
      <table cellpadding="0" cellspacing="0" align="center" border="0" width="100%">
        <tr>
          <td style="height: 30px;" align="center">
            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle.png" width="30" align="left" style="display: inline; position: absolute; z-index: 100; left: 34%; top: 17.5%;" />
            <div style="width: 13%; height: 17px; padding: 0px; display: inline; position: absolute; color: #FFF; font-size: 12px; z-index: 50; padding-left: 5px; top: 18.5%; left: 35%;" id="line-hex-1">API Life Cycle</div>
            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle.png" width="30" align="right" style="display: inline; position: absolute; z-index: 100; left: 47%; top: 17.5%; float:right;" />
          </td>
        </tr>
        <tr>
          <td>
            <table cellpading="0" cellspacing="0" align="center" width="100%" border="0">
              <tr>
                <td style="vertical-align: middle; padding: 1px;" width="75">
                  <img src="" width="75" style="padding: 1px;" id="line-image" />
                </td>
                <td style="font-size: 28px; font-weight: bold; vertical-align: middle;" id="line-name" width="90%"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td style="font-size: 20px; height: 40px; font-weight: bold; color:#000; background-color: #FFF; padding: 3px;" align="center" id="line-area">
            {"Area"}
          </td>
        </tr>
        <tr>
          <td style="padding-left: 30px;">

            <a href="#" onclick="loadstops('prev'); return false;"><img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-api-subway-circle-previous.png" width="175" style="position: absolute; z-index: 100; left: 33.75%;" id="prev-circle" /></a>

            <div style="width: 30px; height: 300px; margin-top:5px; background-color: #00933C; position: absolute; z-index: 50; left: 34.55%;" id="line-hex-2"></div>

            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle.png" width="50" style="position: absolute; z-index: 100; left: 33.75%; top:53%; display: none;" id="stop-one-circle" />
            <div style="font-size: 18px; font-weight: bold; position: absolute; z-index: 100; left: 38%; top:54%; display: none;" id="stop-one-name">Stop One</div>

            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle-red-center.png" width="50" style="position: absolute; z-index: 100; left: 33.75%; top:63%; display: none;" id="stop-two-circle" />
            <div style="font-size: 24px; font-weight: bold; position: absolute; z-index: 100; left: 38%; top:64%; display: none;" id="stop-two-name">Stop Two</div>

            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle.png" width="50" style="position: absolute; z-index: 100; left: 33.75%; top:73%; display: none;" id="stop-three-circle" />
            <div style="font-size: 18px; font-weight: bold; position: absolute; z-index: 100; left: 38%; top:74%; display: none;" id="stop-three-name">Stop Three</div>

            <img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-round-black-circle.png" width="50" style="position: absolute; z-index: 100; left: 33.75%; top:83%; display: none;" id="stop-four-circle" />
            <div style="font-size: 18px; font-weight: bold; position: absolute; z-index: 100; left: 38%; top:84%; display: none;" id="stop-four-name">Stop Four</div>

            <a href="#" onclick="loadstops('next'); return false;"><img id="next-circle" src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-api-subway-circle-next.png" width="175" style="position: absolute; z-index: 100; left: 33.75%; top: 85%;" /></a>
          </td>
        </tr>
      </table>
      <table border="1" cellpadding="5" style="margin-top: 400px; display: none;">
        <tr>
          <td id="totalareas" align="center">0</td>
          <td id="totalstops" align="center">0</td>
        </tr>
        <tr>
          <td id="prevcount" align="center">0</td>
          <td id="nextcount" align="center">0</td>
        </tr>
      </table>
    </td>
    <td width="70%" valign="top" style="padding: 10px;">
      <table cellpading="0" cellspacing="0" align="center" width="85%" border="0" height="385">
        <tr>
          <td colspan="2" id="line-stop-title" style="font-size: 22px; font-weight: bold; padding: 0px;"></td>
        </tr>
        <tr>
          <td colspan="2" id="line-stop-about" style="font-size: 14px; padding: 0px;"></td>
        </tr>
        <tr>
          <td style="padding-left:25px;">
            <table>
              <tr>
                <td colspan="2" id="line-stop-links-title" style="font-size: 16px; font-weight: bold; padding: 1px;">Links</td>
              </tr>
              <tr>
                <td id="line-stop-links-title" style="font-size: 11px;">
                  <ul style="padding: 1px 0px 1px 25px;">
                    <li>Link One</li>
                    <li>Link Two</li>
                    <li>Link Three</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td id="line-stop-organizations-title" style="font-size: 16px; font-weight: bold; padding: 1px;">Organizations</td>
              </tr>
              <tr>
                <td id="line-stop-organizations-title" style="font-size: 11px;">
                  <ul style="padding: 1px 0px 1px 25px;">
                    <li>Organization One</li>
                    <li>Organization Two</li>
                    <li>Organization Three</li>
                  </ul>
                </td>
              </tr>
            </table>
          </td>
          <td>
            <table>
              <tr>
                <td id="line-stop-tools-title" style="font-size: 16px; font-weight: bold; padding: 1px;">Tools</td>
              </tr>
              <tr>
                <td id="line-stop-organizations-title" style="font-size: 11px;">
                  <ul style="padding: 1px 0px 1px 25px;">
                    <li>Tool One</li>
                    <li>Tool Two</li>
                    <li>Tool Three</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td id="line-stop-questions-title" style="font-size: 16px; font-weight: bold; padding: 1px;">Questions</td>
              </tr>
              <tr>
                <td id="line-stop-organizations-title" style="font-size: 11px;">
                  <ul style="padding: 1px 0px 1px 25px;">
                    <li>Question One</li>
                    <li>Question Two</li>
                    <li>Question Three</li>
                  </ul>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
